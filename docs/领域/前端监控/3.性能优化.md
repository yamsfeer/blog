# 性能优化

## 按传统指标优化

### 网络优化

* 使用 http2

  兼容性：当浏览器不支持 http2 时，要降级

  早期浏览器会限制同一个域名下的并发请求连接数，因此以前可以将资源放在不同的域名下，但在 http2 中，为了支持多路复用，反而应该放在同一域名下。

* 开启 brotli 压缩

  ```http
  accept-encoding: gzip,deflate,br
  ```

  与 gzip 相比，brotli 压缩具有更高的压缩比和压缩速度。

* 使用 https

  优化手段：如 session resume、OCSP stapling 等可以提升 https 性能

* CDN 部署静态资源

* DNS 预解析

  ```html
  <link rel="dns-prefetch" href="xx.com">
  ```

  

* 提前建立网络连接

  ```html
  <link rel="preconnect" href="xx.com">
  ```

  

### 缓存优化

```
memory cache
cache api
http cache 强缓存与协商缓存
push cache
server
```



### 资源加载优化

主要有请求时机、文件体积、加载方式等方向。

* html

  * 控制体积在 30kb 以内
  * 优化 dom 节点
  * 压缩
  * 减少内联

* css、字体、图片

  * 关键的先请求
  * 减小文件体积
  * 减少请求数、使用缓存

* js

  * defer、async、动态加载
  * 压缩、tree shaking、按需加载、控制 polyfill
  * 打包、利用缓存

  

## 按用户指标

### 优化 FP / FCP

### 