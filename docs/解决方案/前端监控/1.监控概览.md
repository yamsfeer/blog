# 监控概览

监控的作用：提升稳定性、提升用户体验、建立性能规范、

## 监控流程

### 数据采集

* PV 监控：页面切换后的 url、页面切换原因
* JS 错误：错误的类型、描述、行列号、堆栈、错误上下文
* 性能监控：首屏加载各阶段耗时、性能指标、SPA 切换耗时、longtask
* 请求监控：请求的路径、状态码、请求头、响应头、请求各阶段的耗时
* 白屏监控：白屏发生的页面、关联的异常、相关上下文
* 静态资源监控
* 用户行为监控
* 自定义监控

### 组装上报

* 基础信息：页面路径、部署版本、网络等
* 采样逻辑：条件采样，如某些页面不采样
* 自定义逻辑执行：补充上下文、数据脱敏等
* 队列暂存和聚合发送
* `navigator.sendBeacon`：在页面关闭时发送，不阻塞页面卸载

### 存储

* User-Agent 解析：浏览器版本、系统版本、机型、设备类型等
* IP 解析：地理位置、网络运营商等信息
* 分类型落表落库
* 处理 JS 错误
* clickhouse 存储

### 数据消费

* 总览分析
* 各功能模块消费视角、多维分析
* 单点查询
* 数据订阅、实时报警
* issue 管理、归因分析

## 监控指标

* 可交互性

  * 卡顿监控
  * 请求性能

* 服务稳定性

  * 请求成功率

* 加载速度

  * 首屏性能

* 可用性

  * 渲染错误、白屏
  * 请求错误
  * JS错误
  * 静态资源错误

* 业务数据

  * PV / UV

  * 自定义事件打点

    