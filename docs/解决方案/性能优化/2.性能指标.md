# 性能指标

## 传统性能指标

## 以用户为中心的性能指标

* FCP ( First Contenful Paint )

  首次有内容的渲染时间点

* TTI ( Time To Interactive )

  页面从开始加载到主要资源渲染完成，并能快速、可靠地响应用户输入的时间

* FID ( First Input Delay )

  从用户第一次与页面交互到浏览器能对交互做出响应的时间。


* LCP ( Largest Contentful Paint )

  最大的内容在可视区域内变得可见的时间点。

* TBT ( Total Blocking Time )

  从 FCP 到 TTI 之间所有长任务的阻塞时间之和，量化页面无法响应用户输入的时间有多久。

* CLS ( Cumulative Layout Shift )

  量化页面加载期间，视口中元素的移动程度。

* TTFB ( Time to First Byte )

* INP ( Interaction to Next Paint ) 与下一次绘制的交互



* FP ( First Paint )

  首次渲染的时间点。

* FMP ( First Meaningful Paint )

  首次绘制有意义内容的时间点。

  FMP 的计算方式：页面加载渲染过程中最大布局变动之后的时间点。

  假定 DOM 结构变化和渲染时间点近似相同，则 FMP 的时间点为 DOM 结构变化最剧烈的时间点。

  用 MutationObserver 监听页面的 DOM 变化，计算当前 DOM 树的分数，分数变化最剧烈的时刻，即为 FMP 的时间点。

* SI ( Speed Index )

  衡量页面可视区域加载速度



* 经过测试，LCP 非常近似于 FMP，可以用 LCP 取代 FMP
* SI 的计算比较复杂，且更常用于 lighthouse 而非线上监控
* 用户交互会影响 TBT 的结果，从而导致报告中出现大量差异，线上监控推荐使用  FID

### 小结

|  用户体验  |                             指标                             |
| :--------: | :----------------------------------------------------------: |
|  发生了吗  |      FP ( First Paint ), FCP ( FIrst Contenful Paint )       |
| 内容有用吗 | FMP ( First Meanintful Paint ), SI ( Speed Index ), LCP ( Largest Contentful Paint ) |
| 内容可用吗 |   TTI ( Time To Interactive ), TBT ( Total Blocking Time )   |
| 令人愉悦吗 |  FID ( First Input Delay ), CLS ( Cumulative Layout Shift )  |



|  指标功能  |        指标        | 核心 |
| :--------: | :----------------: | :--: |
|  加载性能  |  TTFB, FCP, LCP,   | LCP  |
|   交互性   | FID, TBT, TTI, INP | FID  |
| 视觉稳定性 |        CLS         | CLS  |



## 指标阈值

|            Metric Name            | Good(ms) | Poor(ms) |
| :-------------------------------: | :------: | :------: |
|    TTFB ( Time to First Byte )    |   800    |   1800   |
|   FCP ( FIrst Contenful Paint )   |   1800   |   3000   |
| LCP ( Largest Contentful Paint )  |   2500   |   4000   |
|     FID ( First Input Delay )     |   100    |   300    |
|     TBT ( Total Block Time )      |   300    |   600    |
|    TTI ( Time To Interactive )    |   3800   |   7300   |
| INP ( Interaction to Next Paint ) |   200    |   500    |
|  CLS ( Cumulative Layout Shift )  |   0.1    |   0.25   |



如果一个网站有至少 75% 的页面浏览量达到"良好"阈值，则该网站在这项指标下就会被归类为性能"良好"。

## 满意度计算

|          Audit           | Weight |
| :----------------------: | :----: |
|  First Contentful Paint  |  10%   |
|       Speed Index        |  10%   |
| Largest Contentful Paint |  25%   |
|   Total Blocking Time    |  30%   |
| Cumulative Layout Shift  |  25%   |



## 指标测量工具

![支持各项核心 Web 指标的 Chrome 和搜索工具摘要](https://raw.githubusercontent.com/yamsfeer/pic-bed/master/V00vjrHmwzljYo04f3d3.png)

## 参考

[以用户为中心的性能指标](https://web.dev/metrics/)

[核心 Web 指标的测量工具](https://web.dev/vitals-tools/)
