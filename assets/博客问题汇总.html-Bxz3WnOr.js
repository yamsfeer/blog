import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as s,o,c as r,b as a,d as e,e as p,a as c}from"./app-BPFsuHku.js";const l={},i=c(`<h1 id="博客问题汇总" tabindex="-1"><a class="header-anchor" href="#博客问题汇总"><span>博客问题汇总</span></a></h1><h2 id="打包内存不足" tabindex="-1"><a class="header-anchor" href="#打包内存不足"><span>打包内存不足</span></a></h2><p>markdown 文件多了以后，除了打包时间加长以外，还会有内存不足的问题。</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code> Compiling with vite
&lt;--- Last few GCs ---&gt;

[12287:0x7fc62092b000] 60958 ms: Scavenge 2010.3 (2082.5) -&gt; 2005.5 (2084.0) MB, 7.4 / 0.0 ms (average mu = 0.807, current mu = 0.719) allocation failure;
...

&lt;--- JS stacktrace ---&gt;

FATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory
...
</code></pre></div><p>这是因为 node 对内存的使用的默认上限为 1.7G，文件过多而内存不足时打包失败。解决办法就是手动提高上限。</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">node</span> --max-old-space-size<span class="token operator">=</span><span class="token number">4096</span> build.js
</code></pre></div><p>或者直接修改环境变量。</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span>--max_old_space_size<span class="token operator">=</span><span class="token number">4096</span>
</code></pre></div><p>如果使用 github 工作流，修改方法如下：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>name: Build project
env:
  NODE_OPTIONS: --max_old_space_size=4096
run: npm run build
</code></pre></div><h2 id="图床" tabindex="-1"><a class="header-anchor" href="#图床"><span>图床</span></a></h2><p>原来使用新浪微博作为图床，上传和访问图片都很方便，但微博开启防盗链后，线上图片全部 403。</p><p>要想绕过防盗链也相对容易，只需在 http 请求头加入</p><div class="language-http" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">referrer</span><span class="token punctuation">:</span> <span class="token header-value">noreferrer</span></span>
</code></pre></div><p>但这只是暂时解决，要想保护图片的安全，最好是自己搭建图床。</p><p>七牛云提供免费的 10G 对象存储空间，足够存放博客的图片，但要想公网访问，需要绑定域名，而购买使用域名需要备案，备案又需要提供一个 ECS 的 IP 地址。</p>`,16),d={href:"https://github.com/yamsfeer/update-pic-bed",target:"_blank",rel:"noopener noreferrer"};function m(h,u){const t=s("ExternalLinkIcon");return o(),r("div",null,[i,a("p",null,[e("综上，由于种种原因，目前我暂时使用 github 仓库作为图床，七牛云做图片备份。另外，我写了一个"),a("a",d,[e("脚本"),p(t)]),e("，提取文章中的图片地址并下载，然后自动上传到 github 仓库和云对象存储。")])])}const f=n(l,[["render",m],["__file","博客问题汇总.html.vue"]]),x=JSON.parse('{"path":"/clutter/%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.html","title":"博客问题汇总","lang":"zh-CN","frontmatter":{"description":"博客问题汇总 打包内存不足 markdown 文件多了以后，除了打包时间加长以外，还会有内存不足的问题。 这是因为 node 对内存的使用的默认上限为 1.7G，文件过多而内存不足时打包失败。解决办法就是手动提高上限。 或者直接修改环境变量。 如果使用 github 工作流，修改方法如下： 图床 原来使用新浪微博作为图床，上传和访问图片都很方便，但微博...","head":[["meta",{"property":"og:url","content":"https://yamsfeer.github.io/notes-fe/clutter/%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.html"}],["meta",{"property":"og:site_name","content":"yamsfeer"}],["meta",{"property":"og:title","content":"博客问题汇总"}],["meta",{"property":"og:description","content":"博客问题汇总 打包内存不足 markdown 文件多了以后，除了打包时间加长以外，还会有内存不足的问题。 这是因为 node 对内存的使用的默认上限为 1.7G，文件过多而内存不足时打包失败。解决办法就是手动提高上限。 或者直接修改环境变量。 如果使用 github 工作流，修改方法如下： 图床 原来使用新浪微博作为图床，上传和访问图片都很方便，但微博..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T16:21:32.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T16:21:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"博客问题汇总\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T16:21:32.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"打包内存不足","slug":"打包内存不足","link":"#打包内存不足","children":[]},{"level":2,"title":"图床","slug":"图床","link":"#图床","children":[]}],"git":{"createdTime":1712938892000,"updatedTime":1712938892000,"contributors":[{"name":"yamsfeer","email":"feer.yams@gmail.com","commits":1}]},"readingTime":{"minutes":1.33,"words":400},"filePathRelative":"clutter/博客问题汇总.md","localizedDate":"2024年4月12日","autoDesc":true}');export{f as comp,x as data};
