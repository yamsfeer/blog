import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as e,c as o,b as a,d as n,e as c,a as l}from"./app-BPFsuHku.js";const i={},u=a("h1",{id:"fetchpriority",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#fetchpriority"},[a("span",null,"fetchpriority")])],-1),r={href:"https://github.com/WICG/priority-hints/blob/main/EXPLAINER.md",target:"_blank",rel:"noopener noreferrer"},k=a("code",null,"fetchpriority",-1),h=l(`<p><code>fetchpriority</code> 属性可以在 <code>link</code>、<code>img</code>、<code>script</code> 标签中使用，它有三种可选值：</p><ul><li>high：相对默认优先级高</li><li>low：相对默认优先级更低</li><li>auto：默认值，相当于没有设置</li></ul><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>photo.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fetchprioroty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>high<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>注意，<strong>fetchpriority 只是一种提示而非要求，浏览器可以根据实际情况处理资源的优先级</strong>。</p><h2 id="图片" tabindex="-1"><a class="header-anchor" href="#图片"><span>图片</span></a></h2><p>通常来说，浏览器会按照文档中出现的顺序加载图像，当发现图片在视口中，则会提高优先级。</p><p>fetchpriority 可以给浏览器一个提示，以便更快获取重要的图像。</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logo.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fetchpriority</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>high<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>carousel.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fetchpriority</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>low<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="async-脚本" tabindex="-1"><a class="header-anchor" href="#async-脚本"><span>async 脚本</span></a></h2><p>浏览器对 blocking script、async script 和 preload script 有不同的优先级。</p><p>如果浏览器默认 preload script 为高优先级，async script 为低优先级，那么 preload 一个 async 脚本的依赖会有问题。</p><p>假如我们有两个脚本 A 和 B，A 导入 B，预加载 B 就可以在加载 A 的同时开始获取。</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但这可能会导致 B 先于 A 被加载，因为 preload 优先级高于 async。</p><p>通过 priority hints 为两个脚本分配相同的优先级，它们就可以按顺序加载。</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span> <span class="token attr-name">fetchpriority</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>high<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fetchpriority</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>high<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="fetch-api" tabindex="-1"><a class="header-anchor" href="#fetch-api"><span>fetch API</span></a></h2><p>fetch API 也可以提供优先级提示。</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/api/prefetch.json&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token string">&#39;low&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
</code></pre></div>`,19);function d(g,m){const t=p("ExternalLinkIcon");return e(),o("div",null,[u,a("p",null,[n("浏览器下载各种类型资源有一个默认的优先级，"),a("a",r,[n("priority-hints"),c(t)]),n(" 可以影响这个优先级。具体来说，是使用 "),k,n(" 属性。")]),h])}const q=s(i,[["render",d],["__file","3.2.2.加载优先级.html.vue"]]),v=JSON.parse('{"path":"/%E5%B7%A5%E7%A8%8B%E6%9E%B6%E6%9E%84/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/3.2.2.%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%85%88%E7%BA%A7.html","title":"fetchpriority","lang":"zh-CN","frontmatter":{"description":"fetchpriority 浏览器下载各种类型资源有一个默认的优先级，priority-hints 可以影响这个优先级。具体来说，是使用 fetchpriority 属性。 fetchpriority 属性可以在 link、img、script 标签中使用，它有三种可选值： high：相对默认优先级高 low：相对默认优先级更低 auto：默认值，相当...","head":[["meta",{"property":"og:url","content":"https://yamsfeer.github.io/notes-fe/%E5%B7%A5%E7%A8%8B%E6%9E%B6%E6%9E%84/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/3.2.2.%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%85%88%E7%BA%A7.html"}],["meta",{"property":"og:site_name","content":"yamsfeer"}],["meta",{"property":"og:title","content":"fetchpriority"}],["meta",{"property":"og:description","content":"fetchpriority 浏览器下载各种类型资源有一个默认的优先级，priority-hints 可以影响这个优先级。具体来说，是使用 fetchpriority 属性。 fetchpriority 属性可以在 link、img、script 标签中使用，它有三种可选值： high：相对默认优先级高 low：相对默认优先级更低 auto：默认值，相当..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T16:21:32.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T16:21:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"fetchpriority\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T16:21:32.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"图片","slug":"图片","link":"#图片","children":[]},{"level":2,"title":"async 脚本","slug":"async-脚本","link":"#async-脚本","children":[]},{"level":2,"title":"fetch API","slug":"fetch-api","link":"#fetch-api","children":[]}],"git":{"createdTime":1712938892000,"updatedTime":1712938892000,"contributors":[{"name":"yamsfeer","email":"feer.yams@gmail.com","commits":1}]},"readingTime":{"minutes":1.35,"words":405},"filePathRelative":"工程架构/性能优化/3.2.2.加载优先级.md","localizedDate":"2024年4月12日","autoDesc":true}');export{q as comp,v as data};
