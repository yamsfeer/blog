import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,o as r,c as p,b as e,d as t,e as a,a as l}from"./app-BPFsuHku.js";const c={},s=l('<h1 id="优化-cls" tabindex="-1"><a class="header-anchor" href="#优化-cls"><span>优化 CLS</span></a></h1><p>CLS 是衡量页面布局偏移的，布局偏移通常由以下情况产生：</p><ul><li>无尺寸的图像</li><li>无尺寸的广告、嵌入内容和 iframe</li><li>动态添加 DOM</li><li>导致 FOIT / FOUT 的网络字体</li><li>属性动画</li></ul><p>减少布局偏移就可优化 CLS。</p><h2 id="无尺寸图像" tabindex="-1"><a class="header-anchor" href="#无尺寸图像"><span>无尺寸图像</span></a></h2><p>为图片提供 width / height 属性，或者设置 aspect-ratio，使得浏览器在获取图像前，在页面上预先分配足够的空间，从而最大限度减少重排。</p><h2 id="广告、嵌入内容和-iframe" tabindex="-1"><a class="header-anchor" href="#广告、嵌入内容和-iframe"><span>广告、嵌入内容和 iframe</span></a></h2><p>要想这些内容不产生布局偏移，最好的办法是设置占位符，即<strong>预留足够空间</strong>。</p><h2 id="动态添加-dom" tabindex="-1"><a class="header-anchor" href="#动态添加-dom"><span>动态添加 DOM</span></a></h2><p>在某些情况下，动态添加 DOM 节点是用户体验的一部分。例如，加载更多项目到列表或更新列表。在这些情况下，有几种方法可以避免意外布局偏移。</p><ul><li><p>在固定宽高的容器中更新内容。</p></li><li><p>让用户主动加载新内容，这样他们就不会对偏移感到惊讶。</p><p>在用户输入后 500ms 内发生的布局偏移不计入 CLS。</p></li><li><p>无缝加载屏幕外的内容，并向用户叠加一个通知，说明内容已经可用</p><p>例如，显示一个 &quot;向上滚动 &quot;按钮。</p></li></ul><h2 id="导致-foit-fout-的网络字体" tabindex="-1"><a class="header-anchor" href="#导致-foit-fout-的网络字体"><span>导致 FOIT / FOUT 的网络字体</span></a></h2><p>下载和渲染网络字体可能通过两种方式导致布局偏移：</p><ul><li>后备字体替换为新字体 ( 无样式文本闪烁, FOUT )</li><li>新字体完成渲染前显示&quot;不可见&quot;文本 ( 不可见文本闪烁, FOIT )</li></ul><p>以下方法可以减少这种情况：</p>',15),d=l("<li><p><code>font-display</code> 能够修改自定义字体的渲染行为。</p><p>可选项有 <code>auto</code>、<code>swap</code>、<code>block</code>、<code>fallback</code> 和 <code>optional</code>，只有 <code>optional</code> 不会导致重排。</p></li>",1),h={href:"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/webfont-optimization#the_font_loading_api",target:"_blank",rel:"noopener noreferrer"},m=e("li",null,[e("p",null,[t("关键网络字体预加载 "),e("code",null,"<link rel=preload>")])],-1),f=e("li",null,[e("p",null,[t("结合使用 "),e("code",null,"<link rel=preload>"),t(" 和 "),e("code",null,"font-display: optional")])],-1),u={href:"https://web.dev/preload-optional-fonts/",target:"_blank",rel:"noopener noreferrer"},_=e("h2",{id:"动画",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#动画"},[e("span",null,"动画")])],-1),g=e("p",null,"使用 transform 动画，而不是触发布局偏移的属性动画。",-1);function C(E,L){const o=n("ExternalLinkIcon");return r(),p("div",null,[s,e("ul",null,[d,e("li",null,[e("p",null,[e("a",h,[t("字体加载 API"),a(o)]),t(" 可以减少获取字体的时间。")])]),m,f]),e("p",null,[t("参考："),e("a",u,[t("通过预加载可选字体来防止布局偏移和不可见文本闪烁 (FOIT)"),a(o)]),t("。")]),_,g])}const T=i(c,[["render",C],["__file","2.2.3.优化CLS.html.vue"]]),y=JSON.parse('{"path":"/%E5%B7%A5%E7%A8%8B%E6%9E%B6%E6%9E%84/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/2.2.3.%E4%BC%98%E5%8C%96CLS.html","title":"优化 CLS","lang":"zh-CN","frontmatter":{"description":"优化 CLS CLS 是衡量页面布局偏移的，布局偏移通常由以下情况产生： 无尺寸的图像 无尺寸的广告、嵌入内容和 iframe 动态添加 DOM 导致 FOIT / FOUT 的网络字体 属性动画 减少布局偏移就可优化 CLS。 无尺寸图像 为图片提供 width / height 属性，或者设置 aspect-ratio，使得浏览器在获取图像前，在页...","head":[["meta",{"property":"og:url","content":"https://yamsfeer.github.io/notes-fe/%E5%B7%A5%E7%A8%8B%E6%9E%B6%E6%9E%84/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/2.2.3.%E4%BC%98%E5%8C%96CLS.html"}],["meta",{"property":"og:site_name","content":"yamsfeer"}],["meta",{"property":"og:title","content":"优化 CLS"}],["meta",{"property":"og:description","content":"优化 CLS CLS 是衡量页面布局偏移的，布局偏移通常由以下情况产生： 无尺寸的图像 无尺寸的广告、嵌入内容和 iframe 动态添加 DOM 导致 FOIT / FOUT 的网络字体 属性动画 减少布局偏移就可优化 CLS。 无尺寸图像 为图片提供 width / height 属性，或者设置 aspect-ratio，使得浏览器在获取图像前，在页..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T16:21:32.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T16:21:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"优化 CLS\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T16:21:32.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"无尺寸图像","slug":"无尺寸图像","link":"#无尺寸图像","children":[]},{"level":2,"title":"广告、嵌入内容和 iframe","slug":"广告、嵌入内容和-iframe","link":"#广告、嵌入内容和-iframe","children":[]},{"level":2,"title":"动态添加 DOM","slug":"动态添加-dom","link":"#动态添加-dom","children":[]},{"level":2,"title":"导致 FOIT / FOUT 的网络字体","slug":"导致-foit-fout-的网络字体","link":"#导致-foit-fout-的网络字体","children":[]},{"level":2,"title":"动画","slug":"动画","link":"#动画","children":[]}],"git":{"createdTime":1712938892000,"updatedTime":1712938892000,"contributors":[{"name":"yamsfeer","email":"feer.yams@gmail.com","commits":1}]},"readingTime":{"minutes":1.82,"words":547},"filePathRelative":"工程架构/性能优化/2.2.3.优化CLS.md","localizedDate":"2024年4月12日","autoDesc":true}');export{T as comp,y as data};
