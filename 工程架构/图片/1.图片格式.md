# 图片格式

## 矢量图形

矢量图形是**一组关于如何绘制图像的指令**，记录了一系列形状、坐标和路径。

矢量图像在缩放时，图像的点和线会按比例重新绘制，所以矢量图能做到缩放不失真。

SVG ( Scalable Vector Graphics, 可缩放矢量图形 ) 是常见的矢量图像格式。SVG 基于 XML 标记，可以用文本编辑器编辑，也可以用 CSS 和 JavaScript 操作。

```html
<svg viewbox="0 0 20 20">
  <circle cx="10" cy="10" r="5" fill="#F17300" />
</svg>
```

与位图基于像素网格相比，SVG 是非常紧凑的，如果用位图描述一个圆，需要把构成圆的所有像素都描述出来。

当然，高度复杂的图像意味着冗长的指令，以及较大的传输尺寸，复杂的 SVG 在渲染时会更加费力。

因此，SVG 适用于图标等具有**鲜明线条、纯色和清晰定义的形状**的场景。

## 光栅图形

光栅图像是一系列渲染二维网格像素的指令。

常见的光栅图像格式包括 GIF、JPEG、PNG、WebP。每种格式压缩和编码这些指令的方式不同，导致了文件大小的巨大差异。以 JPEG 编码的摄影图像可能只有几百 KB，而以 PNG 编码同一图像可能有几百万 KB，但质量却没有明显的差异。

缩放光栅图像超出其固有尺寸，会出现扭曲、块状或模糊的现象。因此，光栅图像适用于**拥有丰富细节**的真实世界。

在传输光栅图像时，服务器发送的是描述该图像的像素网格字节流。

将像素网格编码为字节流数据的过程大概如下：

```
从左上角开始
第一行第一列是蓝色
第一行第二列是蓝色
第一行第三列是蓝色
第一行第四列是橙色
```

根据这些文字信息，客户端可以重现服务器上的图像。

<div style="display: flex; gap: 5px">
  <div style="width: 120px; height: 120px; background: #054A91"></div>
  <div style="width: 120px; height: 120px; background: #054A91"></div>
  <div style="width: 120px; height: 120px; background: #054A91"></div>
  <div style="width: 120px; height: 120px; background: #F17300"></div>
</div>

这张图片还可以换一种描述方法。

```
从左上角开始。
第一行，第一至第三列是蓝色。
第一行，第四列是橙色。
```

渲染同一张图片，但传输的指令却变少了，这是一种**无损压缩**的方法。

值得注意的是，人的眼睛没有完美的保真度，对于人眼无法察觉的变化也可以压缩。

## 图片格式

|  格式   | Alpha 通道 |  动画  | 编解码性能 | 压缩算法  |  颜色  | 兼容性 |
| :-----: | :--------: | :----: | :--------: | :-------: | :----: | :----: |
|   GIF   |    支持    |  支持  |     高     |   无损    | 索引色 |  ALL   |
|   PNG   |    支持    | 不支持 |     高     |   无损    | 索引色 |  ALL   |
|  JPEG   |   不支持   | 不支持 |     高     |   有损    | 直接色 |  ALL   |
|  WebP   |    支持    |  支持  |     差     | 有损/无损 | 直接色 | 高版本 |
|  AVIF   |    支持    |  支持  |     中     | 有损/无损 | 直接色 | 高版本 |
| JPEG XL |    支持    |  支持  |   渐进式   | 有损/无损 | 直接色 | 高版本 |

* Alpha 通道：是否支持半透明
* 动画：是否支持多帧率动态图片，GIF 是典型的动态图片格式
* 编解码性能：图片格式不同正是因为它们使用了不同的编码解码算法，算法性能决定了生成和显示图片的速度
* 压缩算法：压缩算法分为无损压缩和有损压缩
* 颜色支持：分为索引色和直接色
* 兼容性：新的图片格式通常意味着较差的兼容性

## 参考

[现代图片性能优化及体验优化指南](https://juejin.cn/post/7208571916155895864)

[图片与格式：计算机通用图像知识与文件格式](https://www.bilibili.com/video/BV1St4y147PT/)
